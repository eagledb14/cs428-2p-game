"use strict";var I=require("path"),d=require("url"),u=require("./source-map-13827956.cjs"),p=require("./index-d696346e.cjs"),M=require("./resolve-ts-path-43f50656.cjs"),m=require("get-tsconfig"),q=require("fs");function S(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var _=S(I),N=S(q);const l=new Map;async function b(t){if(l.has(t))return l.get(t);if(!await N.default.promises.access(t).then(()=>!0,()=>!1)){l.set(t,void 0);return}const s=await N.default.promises.readFile(t,"utf8");try{const o=JSON.parse(s);return l.set(t,o),o}catch{throw new Error(`Error parsing: ${t}`)}}async function A(t){let e=new URL("package.json",t);for(;!e.pathname.endsWith("/node_modules/package.json");){const s=d.fileURLToPath(e),o=await b(s);if(o)return o;const r=e;if(e=new URL("../package.json",e),e.pathname===r.pathname)break}}async function J(t){var e;const s=await A(t);return(e=s==null?void 0:s.type)!=null?e:"commonjs"}const h=u.installSourceMapSupport(),g=process.env.ESBK_TSCONFIG_PATH?{path:_.default.resolve(process.env.ESBK_TSCONFIG_PATH),config:m.parseTsconfig(process.env.ESBK_TSCONFIG_PATH)}:m.getTsconfig(),k=g&&m.createFilesMatcher(g),O=g&&m.createPathsMatcher(g),w="file://",y=/\.([cm]?ts|[tj]sx)($|\?)/,P=/\.json(?:$|\?)/,W=t=>{const e=_.default.extname(t);if(e===".json")return"json";if(e===".mjs"||e===".mts")return"module";if(e===".cjs"||e===".cts")return"commonjs"},U=t=>{const e=W(t);if(e)return e;if(y.test(t))return J(t)},j=/\/(?:$|\?)/,x=u.compareNodeVersion([20,0,0])>=0;let E=process.send?process.send.bind(process):void 0,T;const C=({port:t})=>(T=t,E=t.postMessage.bind(t),`
	const require = getBuiltin('module').createRequire("${typeof document>"u"?new(require("url")).URL("file:"+__filename).href:document.currentScript&&document.currentScript.src||new URL("loaders-deprecated-630b2616.cjs",document.baseURI).href}");
	require('tsx/source-map').installSourceMapSupport(port);
	if (process.send) {
		port.addListener('message', (message) => {
			if (message.type === 'dependency') {
				process.send(message);
			}
		});
	}
	port.unref(); // Allows process to exit without waiting for port to close
	`),K=x?C:void 0,v=async(t,e,s)=>{const o=await t(e,s);return!o.format&&o.url.startsWith(w)&&(o.format=await U(o.url)),o},B=[".js",".json",".ts",".tsx",".jsx"];async function R(t,e,s){const[o,r]=t.split("?");let c;for(const n of B)try{return await v(s,o+n+(r?`?${r}`:""),e)}catch(a){if(c===void 0&&a instanceof Error){const{message:i}=a;a.message=a.message.replace(`${n}'`,"'"),a.stack=a.stack.replace(i,a.message),c=a}}throw c}async function F(t,e,s){const o=j.test(t),r=o?"index":"/index",[c,n]=t.split("?");try{return await R(c+r+(n?`?${n}`:""),e,s)}catch(a){if(!o)try{return await R(t,e,s)}catch{}const i=a,{message:f}=i;throw i.message=i.message.replace(`${r.replace("/",_.default.sep)}'`,"'"),i.stack=i.stack.replace(f,i.message),i}}const G=/^\.{1,2}\//,H=u.compareNodeVersion([14,13,1])>=0||u.compareNodeVersion([12,20,0])>=0,L=async function(t,e,s,o){var r;if(!H&&t.startsWith("node:")&&(t=t.slice(5)),j.test(t))return await F(t,e,s);const c=t.startsWith(w)||G.test(t);if(O&&!c&&!((r=e.parentURL)!=null&&r.includes("/node_modules/"))){const n=O(t);for(const a of n)try{return await L(d.pathToFileURL(a).toString(),e,s)}catch{}}if(y.test(e.parentURL)){const n=M.resolveTsPath(t);if(n)for(const a of n)try{return await v(s,a,e)}catch(i){const{code:f}=i;if(f!=="ERR_MODULE_NOT_FOUND"&&f!=="ERR_PACKAGE_PATH_NOT_EXPORTED")throw i}}try{return await v(s,t,e)}catch(n){if(n instanceof Error&&!o){const{code:a}=n;if(a==="ERR_UNSUPPORTED_DIR_IMPORT")try{return await F(t,e,s)}catch(i){if(i.code!=="ERR_PACKAGE_IMPORT_NOT_DEFINED")throw i}if(a==="ERR_MODULE_NOT_FOUND")try{return await R(t,e,s)}catch{}}throw n}},V=async function(t,e,s){var o;E&&E({type:"dependency",path:t}),P.test(t)&&(e.importAssertions||(e.importAssertions={}),e.importAssertions.type="json");const r=await s(t,e);if(!r.source)return r;const c=t.startsWith("file://")?d.fileURLToPath(t):t,n=r.source.toString();if(r.format==="json"||y.test(t)){const a=await p.transform(n,c,{tsconfigRaw:(o=k)==null?void 0:o(c)});return{format:"module",source:h(a,t,T)}}if(r.format==="module"){const a=p.transformDynamicImport(c,n);a&&(r.source=h(a,t,T))}return r},Q=async function(t,e,s){if(P.test(t))return{format:"module"};try{return await s(t,e,s)}catch(o){if(o.code==="ERR_UNKNOWN_FILE_EXTENSION"&&t.startsWith(w)){const r=await U(t);if(r)return{format:r}}throw o}},X=async function(t,e,s){var o;const{url:r}=e,c=r.startsWith("file://")?d.fileURLToPath(r):r;if(process.send&&process.send({type:"dependency",path:r}),P.test(r)||y.test(r)){const a=await p.transform(t.toString(),c,{tsconfigRaw:(o=k)==null?void 0:o(c)});return{source:h(a,r)}}const n=await s(t,e,s);if(e.format==="module"){const a=p.transformDynamicImport(c,n.source.toString());a&&(n.source=h(a,r))}return n},D=u.compareNodeVersion([16,12,0])<0,$=D?Q:void 0,z=D?X:void 0;exports.getFormat=$,exports.globalPreload=K,exports.load=V,exports.resolve=L,exports.transformSource=z;
